<main class="flex-grow max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 w-full">

  <h2 class="text-xl sm:text-2xl font-bold mb-8 text-gray-900">Dashboard Overview</h2>

  <!-- Stat Cards -->
  <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-6 mb-12">

    <a href="{% url 'dashboard' %}" class="block">
      <div class="bg-white rounded-xl shadow-lg p-6 flex flex-col items-center justify-center hover:shadow-xl transition-shadow duration-300 cursor-pointer">
        <h3 class="text-sm font-semibold text-gray-500 mb-2 tracking-wide uppercase">Total Complaints</h3>
        <p class="text-3xl sm:text-4xl font-extrabold text-green-600">{{ total_complains }}</p>
      </div>
    </a>

    <a href="{% url 'dashboard' %}?status=pending" class="block">
      <div class="bg-white rounded-xl shadow-lg p-6 flex flex-col items-center justify-center hover:shadow-xl transition-shadow duration-300 cursor-pointer">
        <h3 class="text-sm font-semibold text-gray-500 mb-2 tracking-wide uppercase">Pending Complaints</h3>
        <p class="text-3xl sm:text-4xl font-extrabold text-yellow-500">{{ pending }}</p>
      </div>
    </a>

    <a href="{% url 'dashboard' %}?status=resolved" class="block">
      <div class="bg-white rounded-xl shadow-lg p-6 flex flex-col items-center justify-center hover:shadow-xl transition-shadow duration-300 cursor-pointer">
        <h3 class="text-sm font-semibold text-gray-500 mb-2 tracking-wide uppercase">Resolved Complaints</h3>
        <p class="text-3xl sm:text-4xl font-extrabold text-blue-600">{{ resolved }}</p>
      </div>
    </a>

    <a href="{% url 'dashboard' %}?status=rejected" class="block">
      <div class="bg-white rounded-xl shadow-lg p-6 flex flex-col items-center justify-center hover:shadow-xl transition-shadow duration-300 cursor-pointer">
        <h3 class="text-sm font-semibold text-gray-500 mb-2 tracking-wide uppercase">Rejected Complaints</h3>
        <p class="text-3xl sm:text-4xl font-extrabold text-purple-600">{{ rejected }}</p>
      </div>
    </a>

  </div>

  <h3 class="text-lg sm:text-2xl font-semibold mb-4 text-gray-700">Complain List</h3>

  {% if messages %}
    {% for msg in messages %}
      <p class="text-center bg-gray-300 text-green-600 font-medium mb-4">{{msg}}</p>
    {% endfor %}
  {% endif %}

  <!-- Recent Complaints -->
  <section class="bg-white rounded-xl shadow-lg overflow-x-auto">
    <table class="min-w-full divide-y divide-gray-200 text-gray-700 text-sm sm:text-base">
      <thead class="bg-gray-50">
        <tr>
          <th scope="col" class="px-4 py-3 text-left font-semibold text-gray-500 uppercase tracking-wider">Title</th>
          <th scope="col" class="px-4 py-3 text-left font-semibold text-gray-500 uppercase tracking-wider">User</th>
          <th scope="col" class="px-4 py-3 text-left font-semibold text-gray-500 uppercase tracking-wider">Status</th>
          <th scope="col" class="px-4 py-3 text-left font-semibold text-gray-500 uppercase tracking-wider">Submitted At</th>
          <th scope="col" class="px-4 py-3"></th>
        </tr>
      </thead>
      <tbody class="divide-y divide-gray-100">
        {% for complain in complains %}
        <tr class="hover:bg-green-50 transition">
          <td class="px-4 py-3 whitespace-nowrap">{{ complain.title }}</td>
          <td class="px-4 py-3 whitespace-nowrap">{{ complain.user.first_name }}</td>
          <td class="px-4 py-3 whitespace-nowrap">
            <span class="inline-flex items-center px-3 py-0.5 rounded-full text-xs font-semibold 
              {% if complain.status == 'pending' %}bg-yellow-100 text-yellow-800
              {% elif complain.status == 'resolved' %}bg-blue-100 text-blue-800
              {% elif complain.status == 'rejected' %}bg-purple-100 text-purple-800
              {% else %}bg-gray-100 text-gray-800
              {% endif %}">
              {{ complain.status|upper }}
            </span>
          </td>
          <td class="px-4 py-3 whitespace-nowrap">{{ complain.submitted_at|date:"F j, Y" }}</td>
          <td class="px-4 py-3 whitespace-nowrap text-right">
            {% if request.user.is_staff %}
              <a href="{% url 'complain_detail' complain.id %}" class="px-3 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition">
                See details
              </a>
              <form action="{% url 'delete_complain' complain.id %}" method="POST" style="display:inline;">
                  {% csrf_token %}
                  <button type="submit"
                  class="px-3 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition ml-2">
                  Delete
                  </button>
              </form>

            {% else %}
              <a href="{% url 'complain_detail' complain.id %}" class="px-3 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition">
                See details
              </a>
            {% endif %}
          </td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="5" class="px-4 py-3 text-center text-gray-500">No complaints found.</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </section>
</main>
